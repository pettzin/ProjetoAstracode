<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Astracode</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/css/home.css">
</head>
<body>

    <div class="header">
        <button class="menu-icon" onclick="home()">游</button>
        <div class="title">ASTRACODE</div>
        <div class="profile">
            <div class="settings-icon">丘뙖잺</div>
            <div class="dropdown" id="profileMenu">
                <a href="#">Editar Perfil</a>
                <a href="#">Alterar Senha</a>
                <a href="#">Alterar Email</a>
                <a href="#">Sair</a>
            </div>
        </div>
    </div>

    <div class="cadastro">
        <button id="openDialog">Cadastrar Contato</button>

        <dialog id="contactDialog">
            <h1>Cadastro de Contatos</h1>
            <form id="contactForm">
                <input type="text" id="name" placeholder="Nome" required>
                <input type="email" id="email" placeholder="E-mail" required>
                <input type="text" id="phone" placeholder="Telefone" required>
                <button type="submit">Cadastrar</button>
                <button type="button" id="closeDialog">Cancelar</button>
            </form>
        </dialog>
    
        <h2>Lista de Contatos</h2>
        <ul id="contactList"></ul>
    
    </div>

    <script>
        const openDialogButton = document.getElementById('openDialog');
        const contactDialog = document.getElementById('contactDialog');
        const closeDialogButton = document.getElementById('closeDialog');
        const contactForm = document.getElementById('contactForm');
        const contactList = document.getElementById('contactList');
        const phoneInput = document.getElementById('phone');

        // Fun칞칚o para validar o nome (apenas letras)
        function validateName(name) {
            const regex = /^[a-zA-Z\s]+$/; // Permite apenas letras e espa칞os
            return regex.test(name);
        }

        // Fun칞칚o para validar o e-mail (min칰sculas, sem caracteres especiais al칠m de @ e ., termina com .com, .br, .gov, ou .org e tem dom칤nio como gmail, outlook, etc.)
        function validateEmail(email) {
            const regex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.(com|br|gov|org)$/; 
            const validDomains = ['gmail', 'outlook', 'yahoo', 'hotmail', 'icloud']; // Exemplo de dom칤nios v치lidos
            const emailDomain = email.split('@')[1]?.split('.')[0];

            if (!regex.test(email)) {
                return false; // Caso o e-mail n칚o passe na regex
            }

            // Verifica se o dom칤nio est치 na lista de dom칤nios v치lidos
            return validDomains.includes(emailDomain);
        }

        openDialogButton.addEventListener('click', () => {
            contactDialog.showModal();
        });

        closeDialogButton.addEventListener('click', () => {
            contactDialog.close();
        });

        contactForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const name = document.getElementById('name').value;
            const email = document.getElementById('email').value;

            // Valida o nome e e-mail
            if (!validateName(name)) {
                alert('Nome deve conter apenas letras e espa칞os!');
                return;
            }

            // Converte o e-mail para min칰sculas
            const emailLowerCase = email.toLowerCase();
            document.getElementById('email').value = emailLowerCase; // Atualiza o campo de email

            if (!validateEmail(emailLowerCase)) {
                alert('E-mail inv치lido! Verifique o formato e o dom칤nio.');
                return;
            }

            const listItem = document.createElement('li');
            listItem.classList.add('contact-item');
            
            // Criando o 칤cone de pessoa usando FontAwesome
            const icon = document.createElement('i');
            icon.classList.add('fas', 'fa-user'); // 칈cone de pessoa do FontAwesome
            icon.classList.add('contact-icon'); // Estilo do 칤cone

            const link = document.createElement('a');
            link.href = "#";
            link.textContent = name;
            link.classList.add('contact-link');
            
            listItem.appendChild(icon); // Adicionando o 칤cone  lista
            listItem.appendChild(link); // Adicionando o nome  lista
            
            // Criando o 칤cone de lixeira
            const trashIcon = document.createElement('i');
            trashIcon.classList.add('fas', 'fa-trash'); // 칈cone de lixeira do FontAwesome
            trashIcon.classList.add('trash-icon'); // Estilo do 칤cone

            // Adiciona a lixeira  lista
            trashIcon.addEventListener('click', () => {
                listItem.remove();
                saveContactsToLocalStorage();
            });

            listItem.appendChild(trashIcon);
            contactList.appendChild(listItem);

            contactForm.reset();
            contactDialog.close();
            saveContactsToLocalStorage();
        });

        // Fun칞칚o para salvar os contatos no localStorage
        function saveContactsToLocalStorage() {
            const contacts = [];
            const contactItems = document.querySelectorAll('.contact-item');

            contactItems.forEach(item => {
                const name = item.querySelector('.contact-link').textContent;
                contacts.push(name);
            });

            localStorage.setItem('contacts', JSON.stringify(contacts));
        }

        // Fun칞칚o para carregar os contatos salvos no localStorage
        function loadContactsFromLocalStorage() {
            const contacts = JSON.parse(localStorage.getItem('contacts')) || [];

            contacts.forEach(name => {
                const listItem = document.createElement('li');
                listItem.classList.add('contact-item');
                
                const icon = document.createElement('i');
                icon.classList.add('fas', 'fa-user');
                icon.classList.add('contact-icon');
                
                const link = document.createElement('a');
                link.href = "#";
                link.textContent = name;
                link.classList.add('contact-link');
                
                listItem.appendChild(icon);
                listItem.appendChild(link);
                
                const trashIcon = document.createElement('i');
                trashIcon.classList.add('fas', 'fa-trash');
                trashIcon.classList.add('trash-icon');
                
                trashIcon.addEventListener('click', () => {
                    listItem.remove();
                    saveContactsToLocalStorage();
                });

                listItem.appendChild(trashIcon);
                contactList.appendChild(listItem);
            });
        }

        // Carregar contatos ao iniciar
        window.addEventListener('DOMContentLoaded', loadContactsFromLocalStorage);
        
        function home() {
            alert('Bot칚o Home clicado!');
        }
    </script>

</body>
</html>