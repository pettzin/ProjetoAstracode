<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CruzeiroTech</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="/css/home.css">
</head>
<body>
    <div class="header">
      <button class="menu-icon" onclick="home()">🏠</button>
      <div class="title">CRUZEIRO TECH</div>
      <div class="profile">
        <div class="settings-icon">⚙️</div>
        <div class="dropdown" id="profileMenu">
          <a href="#">Editar Perfil</a>
          <a href="#">Alterar Senha</a>
          <a href="#">Alterar Email</a>
          <a href="#">Sair</a>
        </div>
      </div>
    </div>
  
    <div class="main">
      <!-- Módulo do formulário (cadastro de usuário) -->
      <div class="form-module">
        <div class="image-container">
          <img src="C:\Users\resil\Downloads\pngcruzeiro.png" alt="Imagem de Usuário">
        </div>
        <button id="openDialog">Cadastrar Contato</button>
        <dialog id="contactDialog">
          <h1>Cadastro de Contatos</h1>
          <form id="contactForm">
            <input type="text" id="name" placeholder="Nome" required>
            <input type="email" id="email" placeholder="E-mail" required>
            <input type="text" id="phone" placeholder="Telefone" required>
            <button type="submit">Cadastrar</button>
            <button type="button" id="closeDialog">Cancelar</button>
          </form>
        </dialog>
      </div>
  
      <!-- Módulo da lista de contatos -->
      <div class="list-module">
        <h2>Lista de Contatos</h2>
        <div class="list-container">
          <ul id="contactList"></ul>
        </div>
      </div>
    </div>
  
    <script>
      // Alterna exibição do menu dropdown
      document.querySelector('.settings-icon').addEventListener('click', () => {
        const dropdownMenu = document.getElementById('profileMenu');
        dropdownMenu.style.display = (dropdownMenu.style.display === 'block' ? 'none' : 'block');
      });
  
      // Validação do nome (apenas letras e espaços)
      function validateName(name) {
        const regex = /^[a-zA-Z\s]+$/;
        return regex.test(name);
      }
  
      // Validação do e-mail com domínios específicos
      function validateEmail(email) {
        const regex = /^[a-z0-9._%+-]+@[a-z0-9.-]+\.(com|br|gov|org)$/;
        const validDomains = ['gmail', 'outlook', 'yahoo', 'hotmail', 'icloud'];
        const emailDomain = email.split('@')[1]?.split('.')[0];
      
        if (!regex.test(email)) {
          return false;
        }
        return validDomains.includes(emailDomain);
      }
  
      // Manipulação do diálogo de cadastro
      const openDialogButton = document.getElementById('openDialog');
      const contactDialog = document.getElementById('contactDialog');
      const closeDialogButton = document.getElementById('closeDialog');
      const contactForm = document.getElementById('contactForm');
      const contactList = document.getElementById('contactList');
  
      openDialogButton.addEventListener('click', () => {
        contactDialog.showModal();
      });
  
      closeDialogButton.addEventListener('click', () => {
        contactDialog.close();
      });
  
      contactForm.addEventListener('submit', (e) => {
        e.preventDefault();
  
        const name = document.getElementById('name').value;
        const email = document.getElementById('email').value;
  
        if (!validateName(name)) {
          alert('Nome deve conter apenas letras e espaços!');
          return;
        }
  
        const emailLowerCase = email.toLowerCase();
        document.getElementById('email').value = emailLowerCase;
  
        if (!validateEmail(emailLowerCase)) {
          alert('E-mail inválido! Verifique o formato e o domínio.');
          return;
        }
  
        const listItem = document.createElement('li');
        listItem.classList.add('contact-item');
  
        const icon = document.createElement('i');
        icon.classList.add('fas', 'fa-user', 'contact-icon');
  
        const link = document.createElement('a');
        link.href = "#";
        link.textContent = name;
        link.classList.add('contact-link');
  
        listItem.appendChild(icon);
        listItem.appendChild(link);
  
        const trashIcon = document.createElement('i');
        trashIcon.classList.add('fas', 'fa-trash', 'trash-icon');
        trashIcon.addEventListener('click', () => {
          listItem.remove();
          saveContactsToLocalStorage();
        });
        listItem.appendChild(trashIcon);
  
        contactList.appendChild(listItem);
        contactForm.reset();
        contactDialog.close();
        saveContactsToLocalStorage();
      });
  
      // Salva os contatos no localStorage
      function saveContactsToLocalStorage() {
        const contacts = [];
        const contactItems = document.querySelectorAll('.contact-item');
        contactItems.forEach(item => {
          const name = item.querySelector('.contact-link').textContent;
          contacts.push(name);
        });
        localStorage.setItem('contacts', JSON.stringify(contacts));
      }
  
      // Carrega os contatos do localStorage
      function loadContactsFromLocalStorage() {
        const contacts = JSON.parse(localStorage.getItem('contacts')) || [];
        contacts.forEach(name => {
          const listItem = document.createElement('li');
          listItem.classList.add('contact-item');
      
          const icon = document.createElement('i');
          icon.classList.add('fas', 'fa-user', 'contact-icon');
      
          const link = document.createElement('a');
          link.href = "#";
          link.textContent = name;
          link.classList.add('contact-link');
      
          listItem.appendChild(icon);
          listItem.appendChild(link);
      
          const trashIcon = document.createElement('i');
          trashIcon.classList.add('fas', 'fa-trash', 'trash-icon');
          trashIcon.addEventListener('click', () => {
            listItem.remove();
            saveContactsToLocalStorage();
          });
      
          listItem.appendChild(trashIcon);
          contactList.appendChild(listItem);
        });
      }
  
      window.addEventListener('DOMContentLoaded', loadContactsFromLocalStorage);
  
      function home() {
        alert('Botão Home clicado!');
      }
    </script>
  </body>
  </html>